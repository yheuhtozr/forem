<% _t = "v.settings.extensions.rss" %>
<div class="crayons-card crayons-card--content-rows">
  <div class="grid gap-4">
    <h2 class="crayons-subtitle-1">
      <%= t "heading", scope: _t, community: community_name %>
    </h2>
    <% if @users_setting.feed_url.present? %>
      <%= form_for @users_setting, url: users_settings_path do |f| %>
        <%= f.hidden_field :feed_url, value: @users_setting.feed_url %>
        <%= f.hidden_field :tab, value: @tab %>
        <div class="flex items-center">
          <button type="submit" class="crayons-btn crayons-btn--secondary"><%= t("fetch", scope: _t) %></button>
          <p class="pl-2"><%= t "last_html", scope: _t, time: tag.time(id: "rss-fetch-time", datetime: @users_setting.user.feed_fetched_at.iso8601) %></p>
        </div>
      <% end %>
    <% end %>
    <p>
      <%= t "desc1_html", scope: _t, dashboard: link_to(t("dashboard", scope: _t), "/dashboard") %>
    </p>
    <p><%= t("desc2", scope: _t) %></p>
    <p>
      <%= t "desc3_html", scope: _t, guide: link_to(t("guide", scope: _t), publishing_from_rss_guide_path) %>
    </p>
    <p>
      <%= t("desc4", scope: _t) %>
      <%= t("contact_prompts.if_any_questions_html") %>
    </p>
    <p><%= t("desc5_html", scope: _t) %></p>
    <p><em><%= t("desc6", scope: _t) %></em></p>
  </div>

  <%= form_for @users_setting, url: users_settings_path, html: { class: "grid gap-6" } do |f| %>
    <div class="crayons-field">
      <%= f.label :feed_url, "RSS Feed URL", class: "crayons-field__label" %>
      <%= f.url_field :feed_url, placeholder: "https://yoursite.com/feed", class: "crayons-textfield" %>
    </div>

    <div class="crayons-field crayons-field--checkbox">
      <%= f.check_box :feed_mark_canonical, class: "crayons-checkbox" %>
      <%= f.label :feed_mark_canonical, t("mark_canonical_html", scope: _t), class: "crayons-field__label" %>
    </div>

    <div class="crayons-field crayons-field--checkbox">
      <%= f.check_box :feed_referential_link, class: "crayons-checkbox" %>
      <%= f.label :feed_referential_link, t("referential_html", scope: _t, community: community_name), class: "crayons-field__label" %>
    </div>

    <%= f.hidden_field :tab, value: @tab, id: nil %>
    <% button_text = @users_setting.feed_url.present? ? t("save", scope: _t) : t("submit", scope: _t) %>
    <button class="crayons-btn w-max" type="submit"><%= button_text %></button>
  <% end %>
</div>
