<%= render "style" %>

<h1 class="crayons-title mb-6">Suspicious activity</h1>

<div class="grid gap-6">
  <%= render "abuse_reports" %>

  <div class="crayons-card p-4">
    <%= search_form_for @q, url: admin_feedback_messages_path, class: "flex flex-row flex-wrap items-center crayons-card crayons-card--secondary p-3" do |f| %>

      <%= f.label :reported_url_cont, "Reported URL", class: "crayons-field__label m-1 screen-reader-only" %>
      <%= f.search_field :reported_url_cont, placeholder: "Reported URL", class: "crayons-textfield w-auto m-1" %>

      <%= f.label :reporter_username_cont, "Reporter", class: "crayons-field__label m-1 screen-reader-only" %>
      <%= f.search_field :reporter_username_cont, placeholder: "Reporter", class: "crayons-textfield w-auto m-1" %>

      <%= f.select(:status_eq, options_for_select(%w[Open Invalid Resolved], @q.status_eq), { include_blank: true }, class: "crayons-select w-auto m-1") %>

      <%= f.submit "Search", class: "crayons-btn crayons-btn--secondary m-1" %>
    <% end %>

    <div class="pt-4 px-2 pb-4">
      <strong>Sort:</strong>
      <%= tag.span(sort_link(@q, :reporter_username, "Reporter"), class: "mx-2") %>
      <%= tag.span(sort_link(@q, :reported_url, "Reported URL"), class: "mx-2") %>
      <%= tag.span(sort_link(@q, :created_at, "Creation Date"), class: "ml-2") %>
    </div>

    <%= paginate @feedback_messages %>

    <div class="grid gap-4">
      <% @feedback_messages.each do |feedback_message| %>
        <%= form_for [:admin, feedback_message] do |f| %>
          <%= render "feedback_message", f: f, feedback_message: feedback_message %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>

<%= paginate @feedback_messages %>
